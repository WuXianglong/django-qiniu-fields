function FileProgress(c,b){this.fileProgressID=c.id;this.file=c;this.opacity=100;this.height=0;this.fileProgressWrapper=$("#"+this.fileProgressID);if(!this.fileProgressWrapper.length){this.fileProgressWrapper=$("<div></div>");var e=this.fileProgressWrapper;e.attr("id",this.fileProgressID).addClass("progressContainer");var d=$("<div/>");d.addClass("info");var h=$("<div/>");h.addClass("progress progress-striped");h.attr("style","width: 200px");var g=$("<div/>");g.addClass("progress-bar progress-bar-info").attr("role","progressbar").attr("aria-valuemax",100).attr("aria-valuenow",0).attr("aria-valuein",0).width("0%");h.append(g);d.append(h);var a=$('<span class="status text-center"/>');d.append(a);var f=$("<a href=javascript:; />");f.show().addClass("progressCancel ml15").text("×");d.append(f);e.append(d);$("#"+b).append(e)}else{this.reset()}this.height=this.fileProgressWrapper.offset().top;this.setTimer(null)}FileProgress.prototype.setTimer=function(a){this.fileProgressWrapper.FP_TIMER=a};FileProgress.prototype.getTimer=function(a){return this.fileProgressWrapper.FP_TIMER||null};FileProgress.prototype.reset=function(){this.fileProgressWrapper.attr("class","progressContainer");this.fileProgressWrapper.find("td .progress .progress-bar-info").attr("aria-valuenow",0).width("0%").find("span").text("");this.appear()};FileProgress.prototype.setChunkProgress=function(j){var k=Math.ceil(this.file.size/j);if(k===1){return false}var f=$('<button class="btn btn-default">查看分块上传进度</button>');var e=$('<tr class="chunk-status-tr"><td colspan=3></td></tr>');var g=$("<div/>");for(var c=1;c<=k;c++){var b=$('<div class="col-md-2"/>');var a=$('<div class="progress progress-striped"></div');var d=$("<div/>");d.addClass("progress-bar progress-bar-info text-left").attr("role","progressbar").attr("aria-valuemax",100).attr("aria-valuenow",0).attr("aria-valuein",0).width("0%").attr("id",this.file.id+"_"+c).text("");var h=$("<span/>");h.addClass("chunk-status").text();a.append(d);a.append(h);b.append(a);g.append(b)}if(!this.fileProgressWrapper.find("td:eq(2) .btn-default").length){this.fileProgressWrapper.find("td>div").append(f)}e.hide().find("td").append(g);e.insertAfter(this.fileProgressWrapper)};FileProgress.prototype.setProgress=function(i,o,n){this.fileProgressWrapper.attr("class","progressContainer green");var q=this.file;var r=q.loaded;var k=plupload.formatSize(q.size).toUpperCase(),m=plupload.formatSize(r).toUpperCase();var e=plupload.formatSize(o).toUpperCase();var d=this.fileProgressWrapper.find("div.progress").find(".progress-bar-info");if(this.fileProgressWrapper.find(".status").text()==="取消上传"){return}this.fileProgressWrapper.find(".status").text("已上传: "+m+" / "+k+"  上传速度： "+e+"/s");i=parseInt(i,10);if(q.status!==plupload.DONE&&i===100){i=99}d.attr("aria-valuenow",i).css("width",i+"%");if(n){var f=Math.ceil(q.size/n);if(f===1){return false}var h=Math.ceil(r/n);var b,j;for(var c=0;c<h;c++){b=$("#"+q.id+"_"+c);b.width("100%").removeClass().addClass("alert-success").attr("aria-valuenow",100);j="块"+c+"上传进度100%";b.next().html(j)}var l=$("#"+q.id+"_"+h);var g;if(h<f){if(r%n){g=((r%n)/n*100).toFixed(2)}else{g=100;l.removeClass().addClass("alert-success")}}else{var p=q.size-n*(f-1);var a=q.size-r;if(a%p){g=((r%n)/p*100).toFixed(2)}else{g=100;l.removeClass().addClass("alert-success")}}l.width(g+"%");l.attr("aria-valuenow",g);j="块"+h+"上传进度"+g+"%";l.next().html(j)}this.appear()};FileProgress.prototype.setComplete=function(a,c){var d=this.fileProgressWrapper.find("td:eq(2)"),b=d.find(".progress");b.html("").removeClass().next().next(".status").hide();d.find(".progressCancel").hide()};FileProgress.prototype.setError=function(){this.fileProgressWrapper.find("td:eq(2)").attr("class","text-warning");this.fileProgressWrapper.find("td:eq(2) .progress").css("width",0).hide();this.fileProgressWrapper.find("button").hide();this.fileProgressWrapper.next(".chunk-status-tr").hide()};FileProgress.prototype.setCancelled=function(b){var a="progressContainer";if(!b){a+=" red"}this.fileProgressWrapper.attr("class",a);this.fileProgressWrapper.find("td .progress").remove();this.fileProgressWrapper.find("td:eq(2) .btn-default").hide();this.fileProgressWrapper.find("td:eq(2) .progressCancel").hide()};FileProgress.prototype.setStatus=function(b,a){if(!a){this.fileProgressWrapper.find(".status").text(b).attr("class","status text-left")}};FileProgress.prototype.bindUploadCancel=function(a){var b=this;if(a){b.fileProgressWrapper.find("td:eq(2) .progressCancel").on("click",function(){b.setCancelled(false);b.setStatus("取消上传");b.fileProgressWrapper.find(".status").css("left","0");a.removeFile(b.file)})}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null)}if(this.fileProgressWrapper[0].filters){try{this.fileProgressWrapper[0].filters.item("DXImageTransform.Microsoft.Alpha").opacity=100}catch(a){this.fileProgressWrapper.css("filter","progid:DXImageTransform.Microsoft.Alpha(opacity=100)")}}else{this.fileProgressWrapper.css("opacity",1)
}this.fileProgressWrapper.css("height","");this.height=this.fileProgressWrapper.offset().top;this.opacity=100;this.fileProgressWrapper.show()};